<!DOCTYPE html><html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buscaminas ClÃ¡sico</title>
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 1em;
    }
    h1 {
      margin-bottom: 1em;
    }
    table {
      border-collapse: collapse;
      touch-action: manipulation;
    }
    td {
      width: 48px;
      height: 48px;
      background: #333;
      border: 1px solid #555;
      text-align: center;
      vertical-align: middle;
      font-size: 1.5em;
      user-select: none;
      transition: background 0.1s;
    }
    td.open {
      background: #999;
      color: black;
    }
    td.mine {
      background: red;
    }
    td.flag::after {
      content: "ðŸš©";
    }
  </style>
</head>
<body>
  <h1>Buscaminas</h1>
  <table id="minesweeper"></table>
  <script>
    const rows = 9, cols = 9, mines = 9;
    let board = [];
    let table = document.getElementById("minesweeper");function initBoard() {
  board = [];
  table.innerHTML = "";
  for (let r = 0; r < rows; r++) {
    let row = [];
    let tr = document.createElement("tr");
    for (let c = 0; c < cols; c++) {
      let cell = {
        row: r,
        col: c,
        mine: false,
        open: false,
        flag: false,
        element: document.createElement("td"),
      };
      cell.element.addEventListener("click", () => handleClick(cell));
      cell.element.addEventListener("contextmenu", e => {
        e.preventDefault();
        toggleFlag(cell);
      });
      cell.element.addEventListener("touchstart", e => {
        cell.touchStart = Date.now();
      });
      cell.element.addEventListener("touchend", e => {
        if (Date.now() - cell.touchStart > 500) {
          toggleFlag(cell);
        } else {
          handleClick(cell);
        }
      });
      cell.element.addEventListener("dblclick", () => handleNumberClick(cell));
      tr.appendChild(cell.element);
      row.push(cell);
    }
    board.push(row);
    table.appendChild(tr);
  }
  placeMines();
}

function placeMines() {
  let placed = 0;
  while (placed < mines) {
    let r = Math.floor(Math.random() * rows);
    let c = Math.floor(Math.random() * cols);
    if (!board[r][c].mine) {
      board[r][c].mine = true;
      placed++;
    }
  }
}

function getNeighbors(cell) {
  let neighbors = [];
  for (let dr = -1; dr <= 1; dr++) {
    for (let dc = -1; dc <= 1; dc++) {
      if (dr === 0 && dc === 0) continue;
      let nr = cell.row + dr;
      let nc = cell.col + dc;
      if (nr >= 0 && nr < rows && nc >= 0 && nc < cols) {
        neighbors.push(board[nr][nc]);
      }
    }
  }
  return neighbors;
}

function countMines(cell) {
  return getNeighbors(cell).filter(n => n.mine).length;
}

function toggleFlag(cell) {
  if (cell.open) return;
  cell.flag = !cell.flag;
  cell.element.classList.toggle("flag", cell.flag);
}

function handleClick(cell) {
  if (cell.open || cell.flag) return;
  if (cell.mine) {
    revealMines();
    alert("Â¡Perdiste!");
    setTimeout(initBoard, 1000);
    return;
  }
  openCell(cell);
  checkWin();
}

function handleNumberClick(cell) {
  if (!cell.open) return;
  const neighbors = getNeighbors(cell);
  const flagged = neighbors.filter(n => n.flag).length;
  const mineCount = countMines(cell);
  if (flagged === mineCount) {
    neighbors.forEach(n => {
      if (!n.open && !n.flag) handleClick(n);
    });
  }
}

function openCell(cell) {
  if (cell.open || cell.flag) return;
  cell.open = true;
  cell.element.classList.add("open");
  const minesAround = countMines(cell);
  if (minesAround > 0) {
    cell.element.textContent = minesAround;
  } else {
    getNeighbors(cell).forEach(openCell);
  }
}

function revealMines() {
  board.flat().forEach(cell => {
    if (cell.mine) {
      cell.element.classList.add("mine");
      cell.element.textContent = "ðŸ’£";
    }
  });
}

function checkWin() {
  let unopened = board.flat().filter(c => !c.open);
  if (unopened.length === mines) {
    alert("Â¡Ganaste!");
    setTimeout(initBoard, 1000);
  }
}

initBoard();

  </script>
</body>
</html>